(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5e352c39"],{"03f4":function(e,t,r){"use strict";r.r(t);var o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticStyle:{margin:"40px"}},[r("launchform")],1)},n=[],i=r("5c96"),a=(r("b775"),r("24d2")),l=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-form",{ref:"mainform",attrs:{model:e.form,rules:e.rules,"label-width":"auto"}},[r("h2",[r("i",{staticClass:"el-icon-news"}),e._v(" 基本信息\n  ")]),e._v(" "),r("el-form-item",{staticClass:"short",attrs:{label:"项目标题",prop:"title"}},[r("el-input",{attrs:{placeholder:"请输入项目标题"},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"项目简介",prop:"introduction"}},[r("el-input",{attrs:{placeholder:"请输入项目简介"},model:{value:e.form.introduction,callback:function(t){e.$set(e.form,"introduction",t)},expression:"form.introduction"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"选择标签",prop:"type"}},[r("el-select",{attrs:{placeholder:"请选择项目标签"},on:{input:function(t){return e.clearValidate("type")}},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},[r("el-option",{attrs:{label:"文化教育",value:"WH"}}),e._v(" "),r("el-option",{attrs:{label:"赛会服务",value:"SH"}}),e._v(" "),r("el-option",{attrs:{label:"社区服务",value:"SQ"}}),e._v(" "),r("el-option",{attrs:{label:"医疗健康",value:"YL"}}),e._v(" "),r("el-option",{attrs:{label:"健康残障",value:"JK"}}),e._v(" "),r("el-option",{attrs:{label:"校园讲解",value:"XY"}}),e._v(" "),r("el-option",{attrs:{label:"其他项目",value:"QT"}})],1)],1),e._v(" "),r("el-form-item",{attrs:{label:"项目详情",prop:"content"}},[r("el-input",{attrs:{type:"textarea",rows:6},model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"项目需求",prop:"requirements"}},[r("el-input",{attrs:{type:"textarea",rows:6},model:{value:e.form.requirements,callback:function(t){e.$set(e.form,"requirements",t)},expression:"form.requirements"}})],1),e._v(" "),r("el-form-item",{ref:"upload_item",attrs:{label:"封面图片",prop:"cover"}},[r("el-upload",{ref:"uploader",attrs:{action:"#","list-type":"picture-card","auto-upload":!0,multiple:!1,limit:1,name:"cover","http-request":e.getFile,"on-remove":e.handleCoverRemove}},[r("i",{staticClass:"el-icon-plus",attrs:{slot:"default"},slot:"default"})])],1),e._v(" "),r("el-form-item",{attrs:{label:"报名截止时间",prop:"deadline"}},[r("el-date-picker",{attrs:{type:"datetime",placeholder:"选择日期时间"},model:{value:e.form.deadline,callback:function(t){e.$set(e.form,"deadline",t)},expression:"form.deadline"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"活动起止时间",prop:"time_range"}},[r("el-date-picker",{attrs:{type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.form.time_range,callback:function(t){e.$set(e.form,"time_range",t)},expression:"form.time_range"}})],1),e._v(" "),r("h2",[r("i",{staticClass:"el-icon-document"}),e._v(" 岗位设置\n  ")]),e._v(" "),e._l(e.form.jobs,(function(t,o){return r("el-card",{key:o,staticStyle:{"margin-bottom":"20px"}},[r("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[r("span",[r("i",{staticClass:"el-icon-setting"}),e._v("\n        岗位"+e._s(o+1)+"\n      ")]),e._v(" "),r("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"},on:{click:function(r){return e.rmjob(t)}}},[r("i",{staticClass:"el-icon-delete"}),e._v(" 删除岗位\n      ")])],1),e._v(" "),r("el-form-item",{attrs:{rules:{required:!0,message:"请输入岗位名称",trigger:"blur"},label:"名称"}},[r("el-input",{staticClass:"short",model:{value:t.job_name,callback:function(r){e.$set(t,"job_name",r)},expression:"job.job_name"}})],1),e._v(" "),r("el-form-item",{attrs:{rules:{required:!0,message:"请选择岗位工时",trigger:"blur"},label:"工时"}},[r("el-input",{staticClass:"short",model:{value:t.job_worktime,callback:function(r){e.$set(t,"job_worktime",r)},expression:"job.job_worktime"}})],1),e._v(" "),r("el-form-item",{attrs:{rules:{required:!0,message:"请输入岗位描述",trigger:"blur"},label:"描述"}},[r("el-input",{staticClass:"short",model:{value:t.job_content,callback:function(r){e.$set(t,"job_content",r)},expression:"job.job_content"}})],1),e._v(" "),r("el-form-item",{attrs:{rules:{required:!0,message:"请设置岗位人数",trigger:"blur"},label:"人数"}},[r("el-input",{staticClass:"short",model:{value:t.job_require_num,callback:function(r){e.$set(t,"job_require_num",r)},expression:"job.job_require_num"}})],1)],1)})),e._v(" "),r("div",{staticStyle:{margin:"20px"}},[r("el-button",{on:{click:e.addJob}},[r("i",{staticClass:"el-icon-plus"},[e._v("新增岗位")])])],1),e._v(" "),r("h2",[r("i",{staticClass:"el-icon-edit"}),e._v(" 报名问卷\n  ")]),e._v(" "),e._l(e.form.form,(function(t,o){return r("el-card",{key:t.index,staticStyle:{"margin-bottom":"20px"}},[r("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[r("span",[r("i",{staticClass:"el-icon-setting"}),e._v(" "),"name"==t.bind?r("span",[e._v("\n          报名表单项"+e._s(o+1)+"（该选项以姓名为默认值）\n          "),r("el-tooltip",{attrs:{content:"填写时默认填充项为报名者姓名",placement:"top"}},[r("i",{staticClass:"el-icon-info hb"})])],1):"phone"==t.bind?r("span",[e._v("\n          报名表单项"+e._s(o+1)+"（该选项以电话为默认值）\n          "),r("el-tooltip",{attrs:{content:"填写时默认填充项为报名者联系电话",placement:"top"}},[r("i",{staticClass:"el-icon-info hb"})])],1):"school"==t.bind?r("span",[e._v("\n          报名表单项"+e._s(o+1)+"（该选项以院系为默认值）\n          "),r("el-tooltip",{attrs:{content:"填写时默认填充项为报名者院系",placement:"top"}},[r("i",{staticClass:"el-icon-info hb"})])],1):r("span",[e._v("报名表单项"+e._s(o+1))])]),e._v(" "),r("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"},on:{click:function(r){return e.rmForm(t)}}},[r("i",{staticClass:"el-icon-delete"}),e._v(" 删除表单项\n    ")])],1),e._v(" "),r("el-form-item",{staticStyle:{margin:"10px 0px"},attrs:{label:"文字描述",rules:{required:!0,message:"请输入表单项名称",trigger:"blur"}}},[r("el-input",{staticClass:"short",model:{value:t.text,callback:function(r){e.$set(t,"text",r)},expression:"item.text"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"是否必填"}},[r("el-switch",{model:{value:t.required,callback:function(r){e.$set(t,"required",r)},expression:"item.required"}})],1),e._v(" "),"text"!=t.type?r("el-form-item",{attrs:{label:"设置选项"}},["text"!=t.type?r("el-button",{on:{click:function(r){return e.addFormOption(t)}}},[r("i",{staticClass:"el-icon-plus"},[e._v("添加选项")])]):e._e()],1):e._e(),e._v(" "),e._l(t.options,(function(o,n){return r("el-form-item",{key:o.index,attrs:{label:"选项"+(n+1)}},[r("el-input",{staticClass:"short",model:{value:o.name,callback:function(t){e.$set(o,"name",t)},expression:"option.name"}}),e._v(" "),r("el-button",{on:{click:function(r){return e.rmFormOption(t,o)}}},[r("i",{staticClass:"el-icon-delete"})])],1)}))],2)})),e._v(" "),r("div",{staticStyle:{margin:"25px"}},[r("el-button",{on:{click:function(t){return e.addForm(0)}}},[r("i",{staticClass:"el-icon-plus"},[e._v("新增文本项")])]),e._v(" "),r("el-button",{on:{click:function(t){return e.addForm(1)}}},[r("i",{staticClass:"el-icon-plus"},[e._v("新增单选项")])]),e._v(" "),r("el-button",{on:{click:function(t){return e.addForm(2)}}},[r("i",{staticClass:"el-icon-plus"},[e._v("新增多选项")])])],1),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.submitform}},[e._v("发起项目")])],2)},s=[],c={name:"launchform",data:function(){return{form:{title:void 0,content:void 0,requirements:void 0,cover:void 0,introduction:void 0,type:void 0,form:[{text:"姓名",required:!0,type:"text",bind:"name"},{text:"联系方式",required:!0,type:"text",bind:"phone"},{text:"院系",required:!0,type:"text",bind:"school"}],deadline:void 0,begin_datetime:void 0,end_datetime:void 0,time_range:void 0,jobs:[{job_name:"job1",job_worktime:2.5,job_content:"job1content1",job_require_num:250}]},rules:{title:[{required:!0,message:"请输入项目标题",trigger:"blur"}],content:{required:!0,message:"请输入项目详情",trigger:"blur"},introduction:{required:!0,message:"请输入项目简介",trigger:"blur"},type:{required:!0,message:"请选择项目标签",trigger:"blul"},requirements:{required:!0,message:"请输入项目需求",trigger:"blur"},deadline:{required:!0,message:"请选择报名截止时间",trigger:"blur"},time_range:{required:!0,message:"请选择活动起止时间",trigger:"blur"},jobs:{required:!0,message:"请添加至少一个岗位",trigger:"blur"},form_content:{required:!0,message:"请输入表单项名称",trigger:"blur"},form_option:{required:!0,message:"请输入选项名称",trigger:"blur"},job_name:{required:!0,message:"请输入岗位名称",trigger:"blur"},job_content:{required:!0,message:"请输入岗位描述",trigger:"blur"},cover:{required:!0,message:"请上传封面图片",trigger:"blur"}}}},methods:{rmjob:function(e){console.log(e);var t=this.form.jobs.indexOf(e);-1!==t&&this.form.jobs.splice(t,1)},addJob:function(){this.form.jobs.push({})},clearValidate:function(e){this.$refs.mainform.clearValidate(e)},addForm:function(e){0==e?this.form.form.push({type:"text"}):1==e?this.form.form.push({type:"radioBox",options:[]}):2==e&&this.form.form.push({type:"checkBox",options:[]})},rmForm:function(e){var t=this.form.form.indexOf(e);-1!=t&&this.form.form.splice(t,1)},addFormOption:function(e){var t=this.form.form.indexOf(e);-1!=t&&this.form.form[t].options.push({name:""})},rmFormOption:function(e,t){var r=e.options.indexOf(t);-1!=r&&e.options.splice(r,1)},submitform:function(){var e=this,t=this;this.$refs.uploader.submit(),console.log(this.form),this.$refs.mainform.validate((function(r){if(console.log(r),r){console.log("旧：",e.form);var o=new FormData;o.append("title",e.form.title),o.append("content",e.form.content),o.append("introduction",e.form.introduction),o.append("requirements",e.form.requirements),o.append("type",e.form.type),o.append("cover",e.form.cover),o.append("deadline",new Date(e.form.deadline).toISOString()),o.append("begin_datetime",new Date(e.form.time_range[0]).toISOString()),o.append("end_datetime",new Date(e.form.time_range[1]).toISOString()),o.append("jobs",JSON.stringify(e.form.jobs)),o.append("form",JSON.stringify(e.form.form)),Object(a["f"])(o).then((function(e){Object(i["Message"])({message:"成功发起项目",type:"success",duration:5e3}),t.$router.push({path:"/dashboard"})})).catch((function(e){Object(i["Message"])({message:"错误："+e,type:"error",duration:5e3})}))}}))},getFile:function(e){console.log("重置cover！"),this.$refs.mainform.clearValidate("cover"),this.form.cover=e.file},handleCoverRemove:function(){console.log("清除cover！"),this.form.cover=void 0}}},u=c,m=(r("df49"),r("2877")),d=Object(m["a"])(u,l,s,!1,null,null,null),p=d.exports,f={name:"Project",components:{launchform:p},data:function(){return{}},methods:{}},b=f,v=Object(m["a"])(b,o,n,!1,null,null,null);t["default"]=v.exports},"24d2":function(e,t,r){"use strict";r.d(t,"d",(function(){return n})),r.d(t,"c",(function(){return i})),r.d(t,"a",(function(){return a})),r.d(t,"e",(function(){return l})),r.d(t,"b",(function(){return s})),r.d(t,"g",(function(){return c})),r.d(t,"f",(function(){return u}));var o=r("b775");function n(e){return Object(o["a"])({url:"/project/detail?id=".concat(e),method:"get"})}function i(e){return Object(o["a"])({url:"/check/ViewApplyInfo?project_id=".concat(e),method:"get"})}function a(e,t){return Object(o["a"])({url:"/check/CheckOp",method:"post",data:{apply_id:e,checked:t}})}function l(){return Object(o["a"])({url:"/my/allproject",method:"get"})}function s(e){return Object(o["a"])({url:"/worktime/Export?project_id=".concat(e),method:"get"})}function c(e){return Object(o["a"])({url:"/sign/project",method:"post",data:e})}function u(e){return Object(o["a"])({method:"post",url:"/project/detail",data:e})}},"745c":function(e,t,r){},b775:function(e,t,r){"use strict";var o=r("bc3a"),n=r.n(o),i=(r("5c96"),n.a.create({baseURL:"/api",timeout:5e3}));i.interceptors.request.use((function(e){return e}),(function(e){return Promise.reject(e)})),i.interceptors.response.use((function(e){return 200!==e.status?Promise.reject(new Error(e.data||"Error")):e}),(function(e){return Promise.reject(e)})),t["a"]=i},df49:function(e,t,r){"use strict";var o=r("745c"),n=r.n(o);n.a}}]);